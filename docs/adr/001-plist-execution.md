# ADR 001: plistからの実行対応

## ステータス

承認済み

## コンテキスト

macOSのplistから定期的に実行するために、以下の要件を満たす必要がありました：

1. 仮想環境の自動アクティベート
2. 作業ディレクトリの自動設定
3. エラーログの適切な記録

## 決定

以下の変更を実装しました：

1. 実行スクリプトの作成
   - `run.sh`: 仮想環境のアクティベートとPythonスクリプトの実行を担当
   - エラー発生時のログ出力を実装

2. plistファイルの作成
   - `com.notion-metrics-recorder.plist`: LaunchAgentとしての設定
   - 定期的な実行スケジュールの設定
   - 標準出力とエラー出力のログファイル設定

3. インストールスクリプトの作成
   - `install.sh`: plistファイルの配置とLaunchAgentの登録を担当

## 結果

この変更により：

- システム起動時に自動的に実行される
- エラーが発生した場合でもログに記録される
- 仮想環境の管理が自動化される

## 注意事項

- plistファイルは`~/Library/LaunchAgents/`に配置する必要がある
- ログファイルは`~/Library/Logs/notion-metrics-recorder/`に出力される
- 実行権限の付与が必要（`chmod +x run.sh install.sh`） 